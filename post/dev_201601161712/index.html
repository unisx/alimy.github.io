  <!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <title> DogeOS,SmartOS,illumos &middot; Alimy </title>
    
    <link rel="stylesheet" type="text/css" href="http://alimy.me/css/uno.min.css" />
    <link rel="stylesheet" type="text/css" href="http://alimy.me/css/lightGallery.css" />
    
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://alimy.me/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="http://alimy.me/favicon.ico">
    
    <link href="" rel="alternate" type="application/rss+xml" title="Alimy" />
    
    <script src="http://alimy.me/js/jquery.min.js"></script>
    <script src="http://alimy.me/js/main.min.js">
    </script>
</head>

  <body>
    <div id="scriptHeader">
    <span class="mobile btn-mobile-menu">
            <i class="fa fa-bars btn-mobile-menu__icon"></i>
            <i class="fa fa-times btn-mobile-close__icon hidden"> </i>
    </span>
    <header class="
        
            panel-cover panel-cover--collapsed
        " >
    <div class="panel-main">
        <div class="panel-main__inner panel-inverted">
            <div class="panel-main__content"> 
                <a href="http://alimy.me/"> <img src="http://alimy.me/images/logo.jpg" width="80" alt="Alimy logo" class="panel-cover__logo logo" /> </a> 
                <h1 class="panel-cover__title panel-title">
                    <a href="http://alimy.me/">Alimy</a>
                </h1>
                <hr class="panel-cover__divider" />
                <p class="panel-cover__description">  乱花渐欲迷人眼，浅草才能没马蹄。  </p>
                <hr class="panel-cover__divider panel-cover__divider--secondary" />
                <div class="navigation-wrapper">
                    <nav class="cover-navigation cover-navigation--primary">
                        <ul class="navigation">
                            <li class="navigation__item"><a href="http://alimy.me#blog" title="博客首页" class="blog-button">Blog</a> </li>
                            </br>  </ul>
                    </nav> <nav class="cover-navigation navigation--social">
    <ul class="navigation"> 
        
        <li class="navigation__item">
            <a href="http://twitter.com/alimy86" title="@Twitter"> <i class='fa fa-twitter'></i> <span class="label">Twitter</span> </a>
        </li>   
        
        <li class="navigation__item">
            <a href="https://github.com/alimy" title="@GitHub"> <i class='fa fa-github'></i> <span class="label">Github</span> </a>
        </li>  </br>    </ul>
</nav>
 </div>
            </div>
        </div>
        <div class="panel-cover--overlay"></div>
    </div>
</header>
</div>
<noscript>
    <style>
        #scriptHeader {display:none;}
        .navigation-wrapper{
            display: block;
            top: 0;
        }
    </style>

    <header class="panel-cover panel-cover--collapsed" style="background-image: url()">
        <div class="panel-main">
            <div class="panel-main__inner panel-inverted">
                <div class="panel-main__content"> 
                    <a href="http://alimy.me/"> <img src="http://alimy.me/images/logo.jpg" width="80" alt="Alimy logo" class="panel-cover__logo logo" /> </a> 
                    <h1 class="panel-cover__title panel-title">
                        <a href="http://alimy.me/">Alimy</a>
                    </h1>
                    <hr class="panel-cover__divider" />
                    <p class="panel-cover__description">  乱花渐欲迷人眼，浅草才能没马蹄。  </p>
                    <hr class="panel-cover__divider panel-cover__divider--secondary" />
                    <div class="navigation-wrapper">
                        <nav class="cover-navigation cover-navigation--primary">
                            <ul class="navigation">
                                <li class="navigation__item"><a href="http://alimy.me/#blog" title="博客首页" class="blog-button">Blog</a> </li>
                                </br>  </ul>
                        </nav> <nav class="cover-navigation navigation--social">
    <ul class="navigation"> 
        
        <li class="navigation__item">
            <a href="http://twitter.com/alimy86" title="@Twitter"> <i class='fa fa-twitter'></i> <span class="label">Twitter</span> </a>
        </li>   
        
        <li class="navigation__item">
            <a href="https://github.com/alimy" title="@GitHub"> <i class='fa fa-github'></i> <span class="label">Github</span> </a>
        </li>  </br>    </ul>
</nav>
 </div>
                </div>
            </div>
            <div class="panel-cover--overlay"></div>
        </div>
    </header>
</noscript>

    <div class="content-wrapper">
      <div class="content-wrapper__inner">
        <div class="post">
            <h1>DogeOS,SmartOS,illumos</h1>
          
          

<h3 id="sect-这些都是什么:a570edf7f9cf5da971e53a3290dfcb84">&sect;这些都是什么？</h3>

<ul>
<li>都是操作系统</li>
<li>都是云计算操作系统</li>
<li>都是先进的云计算操作系统</li>
<li>都是小众的先进的云计算操作系统<br /></li>
</ul>

<p><del>讲完收工</del></p>

<p>当然不是这么简单 :)</p>

<p>但是也不希望写的太长。以下就尽量言简意垓的把来龙去脉，历史纠纷，以及革命先进性都说清楚。</p>

<h3 id="sect-从illumos开始:a570edf7f9cf5da971e53a3290dfcb84">&sect;从illumos开始</h3>

<p>什么是<a href="http://www.illumos.org">illumos</a>？简单的讲，illumos是OpenSolaris的后续开源项目。万恶的Oracle收购了Sun之后，原有OpenSolaris的开发者基本上都离开了Oracle，组成了illumos社区，继续对OpenSolaris先进的内核进行维护，更新，以及添加nb的新功能。这种事情在Oracle的收购史上似乎一再出现，想想MySQL，OpenOffice，Java，强烈的既视感。</p>

<p>当然，OpenSolaris不是完蛋了，其实还<a href="http://solaris.java.net/">存活着</a>。不过因为核心开发者的出走，都在illumos那边玩，很多<a href="http://www.slideshare.net/ahl0003/illumos-innovations-that-will-never-be-in-oracle-solaris">先进特性</a>（尤以存储和虚拟化方面为甚）都不再回流。</p>

<p>illumos继承了所有OpenSolaris的先进特性，例如ZFS，Zone，Crossbow和Dtrace。简单的总结如下</p>

<ul>
<li><p>ZFS可以说是终极文件系统，提供了卷管理，快照，和所有想得到的nb东西<code>在linux里面，这个功能由
LVM以及一堆不同的文件系统完成</code></p></li>

<li><p>Zone是OS Container，即操作系统隔离，或者叫做轻量级虚拟机<code>linux在Zone出现5年之后，也
模仿开发了LXC功能</code></p></li>

<li><p>Crossbow是网络虚拟化，说白了就是将网卡硬件和软件设备分离，一块硬件对应好多个软件设备，并且
提供了nb的虚拟switch支持<code>linux这部分的成果也基本上进入了内核，在几年之后</code></p></li>

<li><p>Dtrace是系统管理员的终极武器，无痛在线勘察系统瓶颈的手术刀<code>MacOSX借用FreeBSD的成果
移植了Dtrace，构成了Xcode中nb闪闪的instruments功能（乔老爷子亲自宣布的），linux这边
限于授权协议问题，则由IBM联合RedHat克隆了一份，名为SystemTap</code></p></li>
</ul>

<p>然后，在joyent公司里面<a href="http://www.slideshare.net/bcantrill/experiences-porting-kvm-to-smartos">两位神人的努力下</a>，KVM被移植到了illumos内核上，于是illumos也拥有了通常所说的<a href="http://en.wikipedia.org/wiki/Hypervisor">Type 2虚拟化技术</a>。</p>

<p>于是illumos = ZFS + Zone + Crossbow + Dtrace + KVM。所有云计算的关键服务在这里集合，形成了一个为云计算而生的系统内核。</p>

<p>但是需要注意的是illumos只是一个内核（正确的说是，内核(OS)加网络层(Network)，即ON）。在geek的手里，它已经完备;放在生产环境，则还欠缺一个包装。</p>

<h3 id="sect-然后是smartos:a570edf7f9cf5da971e53a3290dfcb84">&sect;然后是SmartOS</h3>

<p>怎么把illumos包装成通常意义上的OS，这是接下来需要考虑的问题，也是最好的商业化的契机。</p>

<p>于是就诞生了一批社区和公司围绕着illumos做包装工作，产品谓之发行版。</p>

<p>第一个明显的方向，即是让GNU工具，也就是通常意义上我们认识的linux部分（Gnome，KDE，X11等等）跑在illumos内核上，组成一个可以天天使用和开发的平台。这方面诞生了<a href="http://www.openindiana.org">OpenIndiana</a>，安装使用这个系统，在感官层次，基本上与linux也区别不大。</p>

<p>但是illumos的优势毕竟不是在桌面系统，而是在服务器上。所以第二个方向，就是打包成一个可以给数据中心使用的云操作系统。这方面的公司，就有<a href="http://www.nexenta.com">nexenta</a>，<a href="http://www.delphix.com">delphix</a>和<a href="http://www.joyent.com">joyent</a>三家公司。前两者集中火力发挥ZFS存储的威力，对准EMC开炮。joyent则走向了云计算，不仅运营自己的公有云，也提供私有云解决方案。</p>

<p><a href="http://www.smartos.org">SmartOS</a>即是joyent在包装illumos方面的答案。joyent将illumos内核和必要的组件和命令行工具，打包成为了一个300MB左右的LiveCD，实现了“启动即拥有云计算能力”这个目标。</p>

<p>joyent公司其实更加为人熟知的，是其<a href="http://www.nodejs.org">nodejs</a>平台。SmartOS里面的关键命令行工具和组件，都是用nodejs来实现的。用javascript来实现严肃认真的服务器功能，或许这很让人觉得有些不可思议。但是joyent就是这样做的，而且用事实证明，他们干的很不错，实现的效率并不比编译好的二进制程序差。</p>

<p>因为KVM技术是由joyent第一次整合进入illumos，所以SmartOS理所当然成为第一个能提供KVM服务（即运行CentOS，Ubuntu和Windows）的illumos发行版。鉴于illumos社区的良好风气，<a href="https://github.com/joyent/illumos-kvm">KVM on illumos</a>从一开始就是开源项目，最后也进入illumos内核。</p>

<p>SmartOS的特点总结如下</p>

<ul>
<li>继承了illumos所有的特点（ZFS + Zone + Crossbow + Dtrace + KVM）<code>linux近年来，在KVM
和LXC进入内核之后，也逐步具有了以上功能，但是网络虚拟化和Dtrace部分，则始终差一点</code></li>
<li>集成了joyent所开发的vmadm，imgadm等工具软件，使得虚拟化部分具有了可操作性<code>linux系统则是
由libvirt+一系列小工具来完成这些功能</code></li>
<li>秉承LiveOS的理念，强调无需安装，将几乎全部的服务器资源留给了租户<code>linux方面，这方面的进步则
不明显，但是有商业公司进行探讨</code></li>
</ul>

<h3 id="sect-project-fifo:a570edf7f9cf5da971e53a3290dfcb84">&sect;Project FiFo</h3>

<p>SmartOS是纯粹为云计算而生的操作系统，出世之后即引起了群众的注意，开始应用。但是数据中心维护的管理员熟知，安装好方才是梦魇的开始。</p>

<ul>
<li>怎么维护系统？</li>
<li>怎么管理系统的各项资源？</li>
<li>怎么进行日常的操作？</li>
<li>怎么监控系统？</li>
<li>怎么处理系统的故障？</li>
<li>怎么升级系统？</li>
</ul>

<p>回答这些问题，方才是系统管理员最终选择一个操作系统的真正考察点。</p>

<p>SmartOS只可以部分的回答上述问题。</p>

<p>joyent是一个商业公司，它并没有把所有的东西都放在SmartOS里面让大家免费使用。准确的说，joyent将回答所有上述问题的*能力*，无私的都放在了SmartOS中。但是体现这些能力的*工具*，或者以更为熟知的术语表述，*运维管理系统*，并没有放出来。joyent的运维管理工具，名为SmartDataCenter，是一个商业产品，需要不菲的授权费用才可以使用。</p>

<p>于是使用SmartOS运营数据中心，就变成如下两种常见的方式：</p>

<ol>
<li><p>强者不需要任何运维工具。因为既然能力都已经具备，那么实际上所有事情都可以通过一些基本管理工具，以及API的调用完成。换言之，强者会开发自己的运维系统。</p></li>

<li><p>不具备开发自己运维系统能力的用户。要么就是小规模的使用SmartOS，生产虚拟机之后，即很长时间不去动弹它（SmartOS的稳定性基本可以保证终身不怎么出问题），要么就是去获取SmartDataCetner的授权。</p></li>
</ol>

<p><em>如果有一个开源的运维管理系统就好了？</em></p>

<p>通常我们都会这么想。</p>

<p>运维管理系统的开发，理论上来讲，并不是一个很难的事情，只是需要付出大量的时间和开发精力（因此可能illumos内核那帮家伙不屑去做:)）。然而，这套系统又是运维的核心部分，天然的具有巨大的商业价值。因此不排除有些运营SmartOS的商业公司，开发了这套系统，但是并没有将之开源。</p>

<p>直到<a href="http://www.project-fifo.net">Project FiFo</a>的出现。</p>

<p>Project FiFo贡献了一套开源SmartOS的运维管理系统，它的开发者主要是德国人<a href="https://github.com/Licenser">Heinz N. Gies</a>。FiFo不仅仅是一套运维系统，实际上它还做了更多，完成了镜像管理，高可用，多数据中心管理等多方面的任务。简言之，Project FiFo解决了前面提出的大多数的问题。</p>

<p>让我们感谢Heinz先。</p>

<h3 id="sect-最后是dogeos:a570edf7f9cf5da971e53a3290dfcb84">&sect;最后是DogeOS</h3>

<p>Project FiFo作为一套运维管理系统，补全了SmartOS，但是它并不是SmartOS的一部分。</p>

<p>简单的说，用户仍然需要先安装SmartOS，再安装好FiFo。注意，SmartOS理论上是没有安装这种概念的，但是FiFo作为管理系统，显然是需要安装以解决持久化的问题的。</p>

<p>于是用户再一次可能陷入混乱。</p>

<p>作为一个SmartOS的爱好者，本来我是准备克隆一套SmartDataCenter来扬名立万的:)，但是发现Heinz把这件事情做的这么好，我就放弃了自己开发，转而投入到*粉*Heinz的事业中去。</p>

<p>直到我发现了Project FiFo还并不是SmartOS一部分这个问题，便开始解决这个问题。</p>

<p>我计划将SmartOS拆散重组，整合FiFo进去，形成了一个可能稍微好用一点点的系统。</p>

<p>这个系统被我叫做<a href="http://www.dogeos.net">DogeOS</a>。</p>

<p>一个理想中的，生来用来管理数据中心的，完备的云计算操作系统，终于可能成为现实。</p>

<p>这让我为之兴奋不已。</p>

<hr />

<p><a href="http://liyu1981.github.io/dogeos-smartos-illumos/" title="liyu1981's page">【转载自liyu1981】</a></p>

        </div>
        


<div id="disqus_thread"></div>

<script type="text/javascript">
  var disqusUsername = "alimy";

  (function() { 
  var d = document, s = d.createElement('script');

  s.src = '//' + disqusUsername + '.disqus.com/embed.js';

  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>


      </div>
    </div>
  </body>
  <script>(function(){var WebP=new Image();WebP.onload=WebP.onerror=function(){
if(WebP.height!=2){var sc=document.createElement('script');sc.type='text/javascript';sc.async=true;
var s=document.getElementsByTagName('script')[0];sc.src='/js/webpjs-0.0.2.min.js';s.parentNode.insertBefore(sc,s);}};
WebP.src='data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA';})();</script>

</html>
